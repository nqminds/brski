add_library(serialize serialize.c)
target_link_libraries(serialize PRIVATE os)
target_compile_definitions(serialize PRIVATE _DEFAULT_SOURCE _BSD_SOURCE _XOPEN_SOURCE)

add_library(voucher voucher.c)
if (USE_VOUCHER_OPENSSL AND (NOT USE_VOUCHER_WOLFSSL))
    add_library(crypto_openssl crypto_openssl.c)
    target_link_libraries(crypto_openssl PRIVATE OpenSSL3::Crypto log os)
    target_link_libraries(voucher PUBLIC jsmn::jsmn PRIVATE crypto_openssl serialize os)
    target_compile_definitions(voucher PUBLIC WITH_VOUCHER_OPENSSL)
elseif (USE_VOUCHER_WOLFSSL)
    add_library(crypto_wolfssl crypto_wolfssl.c)
    target_link_libraries(voucher PUBLIC jsmn::jsmn PRIVATE crypto_wolfssl serialize os)
    target_compile_definitions(voucher PUBLIC WITH_VOUCHER_WOLFSSL)
else ()
    target_link_libraries(voucher PUBLIC jsmn::jsmn PRIVATE serialize os)
endif ()

